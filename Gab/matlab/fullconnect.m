clc;clear all;close all;
clc;close all;clear all
s = [-0.9262004494667053, -2.5372302532196045, 1.6662203073501587, 1.3139026165008545];
a = [-1.2218503952026367, 1.6091108322143555, -1.7176702022552490, -1.3305439949035645, -0.0522367917001247, 0.8437575101852417, 0.6780604720115662, 0.9537628889083862, -0.9441447257995606, -1.9007575511932373, -0.2515891492366791, 0.1013076603412628];
t = [0.4422114789485931, 0.5396851897239685, 0.0955637395381927, 0.2292531430721283];
a = a';t = t';
global a_0;global w_0;global b_0;global s_0;global dw_0;global dz_0;global z_0;global lr_0;global mmt_15493808;global dcy_66;global z_7077264;
w_0 = [-0.6088616251945496, -0.1323282718658447, 0.1423280239105225, 0.0509690046310425, -0.4714229702949524, 0.3936533331871033, -0.5397005081176758, -0.4315057992935181, 0.2204667329788208, 0.2692888379096985, 0.2454600334167481, -0.5724813938140869, -0.0989208221435547, -0.5159776210784912, 0.6066539883613586, 0.3315904736518860, 0.1110286116600037, 0.1311926245689392, -0.1399822533130646, -0.1927028000354767, 0.5694196820259094, -0.2465460300445557, 0.5197724699974060, -0.3774788081645966, -0.4998707771301270, 0.5461513400077820, -0.0949683785438538, 0.5537952780723572, 0.4427451491355896, 0.4337556958198547, -0.3780516684055328, -0.0423535704612732, -0.4641278982162476, 0.0284101366996765, -0.5025130510330200, -0.5772545337677002, -0.5353912115097046, 0.4763311743736267, -0.5530155897140503, 0.3660016059875488, -0.3459901511669159, 0.1503314375877380, -0.0629900693893433, 0.2901401519775391, -0.2002837955951691, 0.4764984250068665, 0.4985648989677429, 0.5982162356376648];
w_0 = mshape(w_0,[4,12,1]);
dw_0 = w_0*0;
b_0 = [0.1155689433217049, 0.0672109052538872, 0.2520898878574371, -0.1671420782804489];
b_0 = b_0';
db_0 = b_0*0;
z_0 = [-0.9262004494667053, -2.5372302532196045, 1.6662203073501587, 1.3139026165008545];
z_0 = z_0';
dz_0 = z_0*0;
lr_0 = 0.0099999998;
mmt_0 = 0.0000000000;
dcy0 = 0.0000000000;
a_0 = [];
function predict(a)
global a_0;global w_0;global b_0;global s_0;global dw_0;global dz_0;global z_0;global lr_0;global mmt_3170163;global dcy_20;global z_3170170;
z_0 = w_0 * a + b_0;
a_0 = a;
s_0 = z_0;
end
function back(ds)
global a_0;global w_0;global b_0;global s_0;global dw_0;global dz_0;global z_0;global lr_0;global mmt_7077264;global dcy_4204203;global z_15503920;
dz_0 =ds;
da = w_0' * dz_0;
dw_0 = dz_0 * (a_0');
db_0 = dz_0;
b_0 = b_0 - lr_0*db_0;
w_0 = w_0 - lr_0*dw_0;
end
gp = [];
for i = 1:100
  predict(a);
  ds = s_0 - t;
  gp = [gp var(ds(:),1)];
  plot(gp)
  back(ds);
end
cn =[0, 3.5455856323, 2.4741537571, 1.7264953852, 1.2047699690, 0.8407034874, 0.5866533518, 0.4093741477, 0.2856663764, 0.1993415952, 0.1391030699, 0.0970678777, 0.0677351877, 0.0472664349, 0.0329831392, 0.0230160262, 0.0160608627, 0.0112074660, 0.0078207152, 0.0054573980, 0.0038082339, 0.0026574268, 0.0018543899, 0.0012940178, 0.0009029806, 0.0006301078, 0.0004396987, 0.0003068270, 0.0002141065, 0.0001494049, 0.0001042575, 0.0000727515, 0.0000507673, 0.0000354252, 0.0000247202, 0.0000172500, 0.0000120375, 0.0000083996, 0.0000058618, 0.0000040903, 0.0000028542, 0.0000019917, 0.0000013899, 0.0000009699, 0.0000006769, 0.0000004723, 0.0000003296, 0.0000002300, 0.0000001605, 0.0000001120, 0.0000000781, 0.0000000546, 0.0000000381, 0.0000000266, 0.0000000185, 0.0000000129, 0.0000000090, 0.0000000063, 0.0000000044, 0.0000000031, 0.0000000021, 0.0000000015, 0.0000000010, 0.0000000007, 0.0000000005, 0.0000000004, 0.0000000002, 0.0000000002, 0.0000000001, 0.0000000001, 0.0000000001, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000];
cn = cn(2:end);
figure;
plot(gp);hold on;
plot(cn);
legend('matlab','C')
